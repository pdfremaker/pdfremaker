{% extends "base.html" %}

{% block title %}å‡¦ç†çµæœ - PDF Remaker{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/page_result.css') }}">
<style>
  #debug-section { display: none; } /* æœ€åˆã¯éè¡¨ç¤º */
</style>
{% endblock %}

{% block content %}
<div class="container">
  <h2>å‡¦ç†å®Œäº†ï¼</h2>

  <div class="info">
    <p><strong>å‡¦ç†å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:</strong> {{ pdf_name }}</p>
    <p><strong>ä¿å­˜å…ˆãƒ•ã‚©ãƒ«ãƒ€:</strong> {{ dir_name }}</p>
  </div>

  {{ download_html | safe }}

  <section class="pdf-preview">
    <div style="display:flex;align-items:center;justify-content:space-between;">
      <h2>ğŸ“„ å‡ºåŠ›PDFãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
      <label style="font-weight:bold;">
        <input type="checkbox" id="debugToggle"> DEBUGãƒ¢ãƒ¼ãƒ‰
      </label>
    </div>

    {% if recreated_pdf_url %}
      <iframe src="{{ url_for('serve_output_file', filepath=recreated_pdf_url) }}" width="100%" height="700px"
              style="border:1px solid #ccc;border-radius:8px;"></iframe>
    {% else %}
      <div class="alert">å†æ§‹æˆã•ã‚ŒãŸPDFãŒå­˜åœ¨ã—ãªã„ãŸã‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã¾ã›ã‚“ã€‚</div>
    {% endif %}
  </section>

  <div id="debug-section">
    <details>
      <summary>ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ã NEOãƒ†ã‚­ã‚¹ãƒˆ</summary>
      <div class="styled-content-box">{{ styled_neo_html | safe }}</div>
    </details>

    <details>
      <summary>NEOãƒ†ã‚­ã‚¹ãƒˆ (ã‚¿ã‚°ä»˜ã)</summary>
      <div class="content-box">{{ neo_content }}</div>
    </details>

    <details>
      <summary>OGãƒ†ã‚­ã‚¹ãƒˆ (ã‚¿ã‚°ä»˜ã)</summary>
      <div class="content-box">{{ og_tagged_content }}</div>
    </details>

    <details>
      <summary>æ™‚ç³»åˆ—ã‚½ãƒ¼ãƒˆ</summary>
      <div class="content-box">{{ sorted_content }}</div>
    </details>

    <details open>
      <summary>æŠ½å‡ºç”»åƒ ({{ imgs|length }}æš)</summary>
      <div class="image-gallery">{{ image_gallery_html | safe }}</div>
    </details>
  </div>

  <a href="/" class="action-link back-link">åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ã™ã‚‹</a>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.getElementById("debugToggle");
  const section = document.getElementById("debug-section");

  // ãƒã‚§ãƒƒã‚¯åˆ‡ã‚Šæ›¿ãˆã§debugã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤º
  toggle.addEventListener("change", () => {
    section.style.display = toggle.checked ? "block" : "none";
  });
});
</script>
{% endblock %}